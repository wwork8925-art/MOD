// =============================================================================
// AuthDtos.cs — حاويات بيانات المصادقة (تسجيل الدخول والتسجيل)
// =============================================================================
// DTO = Data Transfer Object
// الفكرة: بدل أن نرسل كائن المستخدم بالكامل من قاعدة البيانات (مع كلمة المرور)،
// نرسل فقط البيانات اللي يحتاجها الطرف الآخر (الفرونت إند).
//
// الأمان: هذه الحاويات تحمي كلمة المرور من الظهور في الاستجابة.
// =============================================================================

namespace backend.DTOs
{
    // -------------------------------------------------------------------------
    // بيانات طلب التسجيل — يرسلها الفرونت إند عند إنشاء حساب جديد
    // -------------------------------------------------------------------------
    public class RegisterDto
    {
        // اسم الدخول (يجب أن يكون فريداً)
        public string Username { get; set; } = string.Empty;

        // كلمة المرور — تُشفَّر بـ PBKDF2 قبل الحفظ في قاعدة البيانات
        public string Password { get; set; } = string.Empty;

        // رقم الهاتف
        public string Number { get; set; } = string.Empty;

        // الرقم المدني
        public string CivilNumber { get; set; } = string.Empty;

        // رابط صورة الملف الشخصي (اختياري)
        public string? ProfileImageUrl { get; set; }
    }

    // -------------------------------------------------------------------------
    // بيانات طلب تسجيل الدخول — يرسلها الفرونت إند عند الدخول
    // -------------------------------------------------------------------------
    public class LoginDto
    {
        // اسم الدخول
        public string Username { get; set; } = string.Empty;

        // كلمة المرور (غير مشفرة — Identity يتحقق منها)
        public string Password { get; set; } = string.Empty;
    }

    // -------------------------------------------------------------------------
    // استجابة المصادقة — يُرجعها الباك إند بعد تسجيل دخول/تسجيل ناجح
    // -------------------------------------------------------------------------
    public class AuthResponseDto
    {
        // رقم المستخدم في قاعدة البيانات
        public int Id { get; set; }

        // اسم الدخول
        public string Username { get; set; } = string.Empty;

        // الدور: "Admin" أو "User"
        public string Role { get; set; } = string.Empty;

        // JWT Token — الفرونت إند يحفظه ويرسله مع كل طلب لاحق
        public string Token { get; set; } = string.Empty;

        // رابط صورة الملف الشخصي
        public string ProfileImageUrl { get; set; } = string.Empty;

        // اسم السكن المعين للمستخدم (null = لم يُعيَّن بعد)
        public string? HostelName { get; set; }
    }
}
